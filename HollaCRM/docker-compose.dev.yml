# Development override
version: '3.8'

services:
  horilla:
    environment:
      - DEBUG=True
      - DJANGO_SETTINGS_MODULE=horilla.settings.development
    volumes:
      - ./horilla:/app
      - horilla_dev_logs:/app/logs
    command: python manage.py runserver 0.0.0.0:8000

  react-dashboard:
    build:
      target: development
    environment:
      - NODE_ENV=development
      - REACT_APP_API_URL=http://localhost:8000/api
    volumes:
      - ./react-dashboard:/app
      - /app/node_modules
    command: npm start
    ports:
      - "3000:3000"

  postgres:
    environment:
      - POSTGRES_DB=horilla_dev
    ports:
      - "5432:5432"

  redis:
    ports:
      - "6379:6379"

  # Development tools
  adminer:
    image: adminer:latest
    restart: always
    ports:
      - "8080:8080"
    networks:
      - horilla_net

  redis-commander:
    image: rediscommander/redis-commander:latest
    restart: always
    environment:
      - REDIS_HOSTS=local:redis:6379:0:${REDIS_PASSWORD:-redis123}
    ports:
      - "8081:8081"
    networks:
      - horilla_net

  # Disable monitoring in dev
  prometheus:
    profiles: []
  grafana:
    profiles: []

volumes:
  horilla_dev_logs:
    driver: local